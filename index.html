<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEMS Task Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .auth-section {
            padding: 30px;
            border-bottom: 1px solid #eee;
        }

        .auth-form {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: end;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 120px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .main-content {
            padding: 30px;
            display: none;
        }

        .task-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .task-form h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .task-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .task-inputs .form-group:last-child {
            grid-column: 1 / -1;
        }

        .tasks-list {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .task-item {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        .task-item:hover {
            background-color: #f8f9fa;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .task-info h4 {
            color: #333;
            margin-bottom: 5px;
        }

        .task-info p {
            color: #666;
            font-size: 14px;
        }

        .task-actions {
            display: flex;
            gap: 10px;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #c3e6cb;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .user-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info span {
            font-weight: 600;
            color: #333;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: #f8f9fa;
            color: #666;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
        }

        .tab-btn:hover {
            background: #5a6fd8;
            color: white;
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-header h3 {
            margin: 0;
            color: #333;
        }

        .profile-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .profile-form h4 {
            margin-bottom: 20px;
            color: #333;
        }

        .user-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .user-info-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .user-info-display h4 {
            color: #333;
            margin-bottom: 10px;
        }

                 .user-info-display p {
             color: #666;
             margin: 5px 0;
         }

         .task-search {
             background: #f8f9fa;
             padding: 20px;
             border-radius: 10px;
             margin-bottom: 20px;
         }

         .task-search h4 {
             margin-bottom: 15px;
             color: #333;
         }

         .search-input {
             display: flex;
             gap: 10px;
             align-items: center;
         }

         .search-input input {
             flex: 1;
             padding: 12px;
             border: 2px solid #ddd;
             border-radius: 8px;
             font-size: 16px;
         }

         .search-input input:focus {
             outline: none;
             border-color: #667eea;
         }

         @media (max-width: 768px) {
            .auth-form {
                flex-direction: column;
            }
            
            .task-inputs {
                grid-template-columns: 1fr;
            }
            
            .task-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .task-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>GEMS Task Manager</h1>
            <p>Simple and efficient task management</p>
            <p style="font-size: 14px; margin-top: 10px; opacity: 0.9;">Note: Registration and login may take 15-20 seconds due to free tier server sleeping</p>
        </div>

        <!-- Authentication Section -->
        <div class="auth-section" id="authSection">
            <div class="auth-form">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" placeholder="Enter your name">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter your password">
                </div>
                <div class="form-group">
                    <button class="btn btn-primary" onclick="register()">Register</button>
                    <button class="btn btn-secondary" onclick="login()">Login</button>
                </div>
            </div>
            <div id="authMessage"></div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <div class="user-info">
                <span id="userInfo">Welcome!</span>
                <button class="btn btn-secondary" onclick="logout()">Logout</button>
            </div>

            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="showTab('tasks')">Tasks</button>
                <button class="tab-btn" onclick="showTab('users')">Users</button>
                <button class="tab-btn" onclick="showTab('profile')">Profile</button>
            </div>

            <!-- Tasks Tab -->
            <div id="tasksTab" class="tab-content active">
                <!-- Task Form -->
                <div class="task-form">
                    <h3>Create New Task</h3>
                    <div class="task-inputs">
                        <div class="form-group">
                            <label for="taskTitle">Title</label>
                            <input type="text" id="taskTitle" placeholder="Enter task title">
                        </div>
                        <div class="form-group">
                            <label for="taskDueDate">Due Date</label>
                            <input type="date" id="taskDueDate">
                        </div>
                        <div class="form-group">
                            <label for="taskDescription">Description</label>
                            <input type="text" id="taskDescription" placeholder="Enter task description">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="createTask()">Create Task</button>
                </div>

                                 <!-- Task Search -->
                 <div class="task-search">
                     <h4>Search Task by ID</h4>
                     <div class="search-input">
                         <input type="text" id="taskSearchId" placeholder="Enter Task ID">
                         <button class="btn btn-secondary" onclick="searchTaskById()">Search</button>
                     </div>
                 </div>

                 <!-- Tasks List -->
                 <div class="tasks-list">
                     <div id="tasksList">
                         <div class="loading">Loading tasks...</div>
                     </div>
                 </div>
            </div>

            <!-- Users Tab -->
            <div id="usersTab" class="tab-content">
                <div class="section-header">
                    <h3>All Users</h3>
                    <button class="btn btn-primary" onclick="loadUsers()">Refresh Users</button>
                </div>
                <div id="usersList">
                    <div class="loading">Loading users...</div>
                </div>
            </div>

            <!-- Profile Tab -->
            <div id="profileTab" class="tab-content">
                <div class="section-header">
                    <h3>My Profile</h3>
                    <button class="btn btn-primary" onclick="loadMyProfile()">Refresh Profile</button>
                </div>
                <div id="profileInfo">
                    <div class="loading">Loading profile...</div>
                </div>
                <div class="profile-form">
                    <h4>Update Profile</h4>
                    <div class="form-group">
                        <label for="updateName">Name</label>
                        <input type="text" id="updateName" placeholder="Enter new name">
                    </div>
                    <div class="form-group">
                        <label for="updateEmail">Email</label>
                        <input type="email" id="updateEmail" placeholder="Enter new email">
                    </div>
                    <button class="btn btn-primary" onclick="updateProfile()">Update Profile</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = 'https://gems-backend-whsr.onrender.com/api';
        let currentUser = null;
        let authToken = localStorage.getItem('authToken');

        // Check if user is already logged in
        if (authToken) {
            showMainContent();
            loadTasks();
        }

        // Authentication Functions
        async function register() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (!name || !email || !password) {
                showAuthMessage('Please fill in all fields', 'error');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ name, email, password }),
                });

                const data = await response.json();

                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    localStorage.setItem('authToken', authToken);
                    showAuthMessage('Registration successful!', 'success');
                    setTimeout(() => {
                        showMainContent();
                        loadTasks();
                    }, 1000);
                } else {
                    showAuthMessage(data.message || 'Registration failed', 'error');
                }
            } catch (error) {
                showAuthMessage('Network error. Please try again.', 'error');
            }
        }

        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (!email || !password) {
                showAuthMessage('Please fill in all fields', 'error');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password }),
                });

                const data = await response.json();

                if (response.ok) {
                    authToken = data.token;
                    currentUser = data;
                    localStorage.setItem('authToken', authToken);
                    showAuthMessage('Login successful!', 'success');
                    setTimeout(() => {
                        showMainContent();
                        loadTasks();
                    }, 1000);
                } else {
                    showAuthMessage(data.message || 'Login failed', 'error');
                }
            } catch (error) {
                showAuthMessage('Network error. Please try again.', 'error');
            }
        }

        function logout() {
            authToken = null;
            currentUser = null;
            localStorage.removeItem('authToken');
            showAuthSection();
        }

        function showAuthMessage(message, type) {
            const messageDiv = document.getElementById('authMessage');
            messageDiv.innerHTML = `<div class="${type}-message">${message}</div>`;
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 3000);
        }

        function showMainContent() {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('userInfo').textContent = `Welcome, ${currentUser.name}!`;
        }

        function showAuthSection() {
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('name').value = '';
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
        }

        // Task Functions
        async function createTask() {
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const dueDate = document.getElementById('taskDueDate').value;

            if (!title || !description) {
                alert('Please fill in title and description');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/tasks`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                    },
                    body: JSON.stringify({
                        title,
                        description,
                        dueDate: dueDate || undefined,
                    }),
                });

                if (response.ok) {
                    document.getElementById('taskTitle').value = '';
                    document.getElementById('taskDescription').value = '';
                    document.getElementById('taskDueDate').value = '';
                    loadTasks();
                } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to create task');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

        async function loadTasks() {
            try {
                const response = await fetch(`${API_BASE}/tasks`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                if (response.ok) {
                    const tasks = await response.json();
                    displayTasks(tasks);
                } else {
                    if (response.status === 401) {
                        logout();
                    } else {
                        document.getElementById('tasksList').innerHTML = '<div class="error-message">Failed to load tasks</div>';
                    }
                }
            } catch (error) {
                document.getElementById('tasksList').innerHTML = '<div class="error-message">Network error</div>';
            }
        }

        function displayTasks(tasks) {
            const tasksList = document.getElementById('tasksList');
            
            if (tasks.length === 0) {
                tasksList.innerHTML = '<div class="loading">No tasks found. Create your first task!</div>';
                return;
            }

                         tasksList.innerHTML = tasks.map(task => `
                 <div class="task-item">
                     <div class="task-info">
                         <h4>${task.title}</h4>
                         <p>${task.description}</p>
                         ${task.dueDate ? `<p><small>Due: ${formatDate(task.dueDate)}</small></p>` : ''}
                         <p><small><strong>ID:</strong> ${task._id}</small></p>
                     </div>
                     <div class="task-actions">
                         <button class="btn btn-secondary" onclick="viewTask('${task._id}')">View</button>
                         <button class="btn btn-secondary" onclick="editTask('${task._id}')">Edit</button>
                         <button class="btn btn-danger" onclick="deleteTask('${task._id}')">Delete</button>
                     </div>
                 </div>
             `).join('');
        }

        async function deleteTask(taskId) {
            if (!confirm('Are you sure you want to delete this task?')) {
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                if (response.ok) {
                    loadTasks();
                } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to delete task');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

        async function editTask(taskId) {
            const newTitle = prompt('Enter new title:');
            const newDescription = prompt('Enter new description:');
            const newDueDate = prompt('Enter new due date (YYYY-MM-DD) or leave empty:');

            if (!newTitle || !newDescription) {
                alert('Title and description are required');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                    },
                    body: JSON.stringify({
                        title: newTitle,
                        description: newDescription,
                        dueDate: newDueDate || undefined,
                    }),
                });

                if (response.ok) {
                    loadTasks();
                } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to update task');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.add('active');
            document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');

            // Load data for the tab
            if (tabName === 'tasks') {
                loadTasks();
            } else if (tabName === 'users') {
                loadUsers();
            } else if (tabName === 'profile') {
                loadMyProfile();
            }
        }

        // User Management Functions
        async function loadUsers() {
            try {
                const response = await fetch(`${API_BASE}/auth/users`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                if (response.ok) {
                    const users = await response.json();
                    displayUsers(users);
                } else {
                    if (response.status === 401) {
                        logout();
                    } else {
                        document.getElementById('usersList').innerHTML = '<div class="error-message">Failed to load users</div>';
                    }
                }
            } catch (error) {
                document.getElementById('usersList').innerHTML = '<div class="error-message">Network error</div>';
            }
        }

        function displayUsers(users) {
            const usersList = document.getElementById('usersList');
            
            if (users.length === 0) {
                usersList.innerHTML = '<div class="loading">No users found.</div>';
                return;
            }

            usersList.innerHTML = users.map(user => `
                <div class="user-item">
                    <div>
                        <h4>${user.name}</h4>
                        <p>${user.email}</p>
                        <small>ID: ${user._id}</small>
                    </div>
                    <button class="btn btn-secondary" onclick="viewUser('${user._id}')">View Details</button>
                </div>
            `).join('');
        }

        async function viewUser(userId) {
            try {
                const response = await fetch(`${API_BASE}/auth/users/${userId}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                if (response.ok) {
                    const user = await response.json();
                    alert(`User Details:\nName: ${user.name}\nEmail: ${user.email}\nID: ${user._id}\nCreated: ${new Date(user.createdAt).toLocaleDateString()}`);
                } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to load user details');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

        async function loadMyProfile() {
            try {
                const response = await fetch(`${API_BASE}/auth/users/${currentUser._id}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                if (response.ok) {
                    const user = await response.json();
                    displayProfile(user);
                } else {
                    document.getElementById('profileInfo').innerHTML = '<div class="error-message">Failed to load profile</div>';
                }
            } catch (error) {
                document.getElementById('profileInfo').innerHTML = '<div class="error-message">Network error</div>';
            }
        }

        function displayProfile(user) {
            const profileInfo = document.getElementById('profileInfo');
            profileInfo.innerHTML = `
                <div class="user-info-display">
                    <h4>${user.name}</h4>
                    <p><strong>Email:</strong> ${user.email}</p>
                    <p><strong>User ID:</strong> ${user._id}</p>
                    <p><strong>Created:</strong> ${new Date(user.createdAt).toLocaleDateString()}</p>
                    <p><strong>Last Updated:</strong> ${new Date(user.updatedAt).toLocaleDateString()}</p>
                </div>
            `;
            
            // Pre-fill update form
            document.getElementById('updateName').value = user.name;
            document.getElementById('updateEmail').value = user.email;
        }

        async function updateProfile() {
            const name = document.getElementById('updateName').value;
            const email = document.getElementById('updateEmail').value;

            if (!name || !email) {
                alert('Please fill in both name and email');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/users/${currentUser._id}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`,
                    },
                    body: JSON.stringify({ name, email }),
                });

                if (response.ok) {
                    const updatedUser = await response.json();
                    currentUser = updatedUser;
                    document.getElementById('userInfo').textContent = `Welcome, ${updatedUser.name}!`;
                    alert('Profile updated successfully!');
                    loadMyProfile();
                } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to update profile');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

                 // Date Formatting Function
         function formatDate(dateString) {
             const date = new Date(dateString);
             const day = date.getDate().toString().padStart(2, '0');
             const month = (date.getMonth() + 1).toString().padStart(2, '0');
             const year = date.getFullYear();
             return `${day}/${month}/${year}`;
         }

         // Task Search Function
         async function searchTaskById() {
             const taskId = document.getElementById('taskSearchId').value.trim();
             
             if (!taskId) {
                 alert('Please enter a Task ID');
                 return;
             }

             try {
                 const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                     headers: {
                         'Authorization': `Bearer ${authToken}`,
                     },
                 });

                 if (response.ok) {
                     const task = await response.json();
                     displaySingleTask(task);
                 } else {
                     const data = await response.json();
                     alert(data.message || 'Task not found');
                 }
             } catch (error) {
                 alert('Network error. Please try again.');
             }
         }

         function displaySingleTask(task) {
             const tasksList = document.getElementById('tasksList');
             tasksList.innerHTML = `
                 <div class="task-item" style="border: 2px solid #667eea; background-color: #f0f4ff;">
                     <div class="task-info">
                         <h4>${task.title}</h4>
                         <p>${task.description}</p>
                         ${task.dueDate ? `<p><small>Due: ${formatDate(task.dueDate)}</small></p>` : ''}
                         <p><small><strong>Task ID:</strong> ${task._id}</small></p>
                         <p><small><strong>Created:</strong> ${formatDate(task.createdAt)}</small></p>
                     </div>
                     <div class="task-actions">
                         <button class="btn btn-secondary" onclick="viewTask('${task._id}')">View</button>
                         <button class="btn btn-secondary" onclick="editTask('${task._id}')">Edit</button>
                         <button class="btn btn-danger" onclick="deleteTask('${task._id}')">Delete</button>
                     </div>
                 </div>
                 <div style="text-align: center; margin-top: 20px;">
                     <button class="btn btn-primary" onclick="loadTasks()">Show All Tasks</button>
                 </div>
             `;
         }

         // Enhanced Task Functions
         async function viewTask(taskId) {
            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                    },
                });

                                 if (response.ok) {
                     const task = await response.json();
                     alert(`Task Details:\nTitle: ${task.title}\nDescription: ${task.description}\nDue Date: ${task.dueDate ? formatDate(task.dueDate) : 'Not set'}\nCreated: ${formatDate(task.createdAt)}\nTask ID: ${task._id}`);
                 } else {
                    const data = await response.json();
                    alert(data.message || 'Failed to load task details');
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }

        // Auto-refresh tasks every 30 seconds
        setInterval(() => {
            if (authToken) {
                loadTasks();
            }
        }, 30000);
    </script>
</body>
</html> 
